---
title: "PreguntaJulia"
author: "Julia"
date: "2024-03-06"
output: html_document
---

Lectura del dataset elegido:

```{r}
data <- read.csv("data/dataMH.csv")
head(data)
```

Elimino las columnas con valores repetidos que no me aportan información:

```{r}
data <- subset(data, select = -c(Code, DIM_SEX))
head(data)
```

Cálculo de la correlación de las distintas variables, con el fin de descubrir cuales están más relacionadas con la tasa de suicidios.

```{r}
library(dplyr)
library(corrplot)

# Cambia el nombre de la columna
data <- data %>% rename(SuicideRate = VALUE_NUMERIC)

# Selecciona las columnas relevantes
data_total <- data[, c("Schizophrenia", "Bipolar.disorders", "Eating.disorders", "Anxiety.disorders", "Drug.use.disorders", "Depression", "Alcohol.use.disorders", "SuicideRate")]

# Calcula la matriz de correlación
correlation_matrix <- cor(data_total, use = "pairwise.complete.obs")

# Visualización con corrplot
corrplot(correlation_matrix, method = "color", type = "upper", order = "hclust", 
         tl.cex = 0.8, tl.col = "black", tl.srt = 45, addCoef.col = "black", number.cex = 0.7)
```

Contraste de hipótesis de las variables de mayor correlación con la tasa de suicidios, para comprobar la relación entre ambas variables:

En primer lugar, realizo el contraste entre la tasa de suicidios y el alcohlísmo para confirmar que la correlación de 0.47 ontenida en la gráfica anterior es correcta.

```{r}
# Suponiendo que tu conjunto de datos se llama 'data'
correlation_alcohol_suicide <- cor(data$Alcohol.use.disorders, data$SuicideRate, use = "complete.obs")

# Realiza un contraste de hipótesis para la correlación
test_result <- cor.test(data$Alcohol.use.disorders, data$SuicideRate, method = "pearson")

# Imprime el resultado del contraste de hipótesis
print(test_result)
```

Como podemos observar, tienen una correlación significativa y positiva entre sí:

1.  **Valor p:** El valor p es muy pequeño (menor que cualquier nivel de significancia común, como 0.05), lo que indica que hay evidencia estadística significativa para rechazar la hipótesis nula. En otras palabras, hay una correlación significativa entre "Alcohol.use.disorders" y "SuicideRate".

2.  **Dirección de la correlación:** Dado que el intervalo de confianza no incluye el valor 0 y el valor de correlación es positivo (0.4678559), puedes concluir que hay una correlación positiva entre las dos variables. A medida que aumenta la tasa de trastornos por uso de alcohol, tiende a aumentar también la tasa de suicidio.

3.  **Intervalo de confianza:** El intervalo de confianza al 95% indica que puedes estar 95% seguro de que la verdadera correlación está dentro del rango del 0.4388302 al 0.4959063.

En segundo lugar, realizo el contraste entre la tasa de suicidios y la depresión para confirmar que la correlación de 0.32 obtenida en la gráfica de correlación anterior es correcta.

```{r}
# Suponiendo que tu conjunto de datos se llama 'data'

# Realiza un contraste de hipótesis para la correlación entre "Depression" y "SuicideRate"
test_result_depression_suicide <- cor.test(data$Depression, data$SuicideRate, method = "pearson")

# Imprime el resultado del contraste de hipótesis
print(test_result_depression_suicide)
```

Como podemos observar, tienen una correlación significativa y positiva entre sí:

1.  **Valor p:** El valor p es muy pequeño (menor que cualquier nivel de significancia común, como 0.05), lo que indica que hay evidencia estadística significativa para rechazar la hipótesis nula. En otras palabras, hay una correlación significativa entre "Depression" y "SuicideRate".

2.  **Dirección de la correlación:** Dado que el intervalo de confianza no incluye el valor 0 y el valor de correlación es positivo (0.320269), puedes concluir que hay una correlación positiva entre las dos variables. A medida que aumenta la variable "Depression", tiende a aumentar también la tasa de suicidio.

3.  **Intervalo de confianza:** El intervalo de confianza al 95% indica que puedes estar 95% seguro de que la verdadera correlación está dentro del rango del 0.2871029 al 0.3526682.

Es cierto, que la correlación no implica causalidad, por tanto hay que tener en cuenta que estos resultados son los obtenidos para este dataset en concreto, podrían variar en algún otro dataset.

```{r}
# Suponiendo que ya tienes un conjunto de datos llamado 'data'
# Y que deseas crear un nuevo dataset con las columnas específicas

# Selecciona las columnas necesarias
nuevo_dataset <- data[, c("Year", "Depression", "Alcohol.use.disorders", "SuicideRate")]

# Muestra las primeras filas del nuevo dataset
head(nuevo_dataset)
```

```{r}
# Suponiendo que ya tienes un conjunto de datos llamado 'data'

library(dplyr)

# Agrupa por año y calcula la media para cada variable
nuevo_dataset_agrupado <- data %>%
  group_by(Year) %>%
  summarise(
    Media_Depression = mean(Depression, na.rm = TRUE),
    Media_Alcohol_use_disorders = mean(Alcohol.use.disorders, na.rm = TRUE),
    Media_SuicideRate = mean(SuicideRate, na.rm = TRUE)
  )

# Muestra las primeras filas del nuevo dataset agrupado
head(nuevo_dataset_agrupado)
```

```{r}
#install.packages("rpart")
#install.packages("rpart.plot")

library(rpart)
library(rpart.plot)

# Suponiendo que tu conjunto de datos se llama 'data'
# y tiene las columnas 'Alcohol.use.disorders', 'Depression', y 'SuicideRate'

# Selecciona las columnas relevantes
datos_regresion <- data[, c("Alcohol.use.disorders", "Depression", "SuicideRate")]

# Ajusta un modelo de regresión de árbol
modelo_arbol <- rpart(SuicideRate ~ Alcohol.use.disorders + Depression, data = datos_regresion)

# Visualiza el árbol de regresión
rpart.plot(modelo_arbol)

```

```{r}
#install.packages("forecast")
library(forecast)

# Suponiendo que tu conjunto de datos se llama 'data'

# Selecciona las columnas relevantes y crea una serie temporal
serie_temporal <- ts(data$SuicideRate, start = data$Year[1], frequency = 1)

# Ajusta un modelo de serie temporal (puedes utilizar otro modelo según tus necesidades)
modelo_serie_temporal <- auto.arima(serie_temporal)

# Realiza predicciones para los próximos 5 años
predicciones <- forecast(modelo_serie_temporal, h = 5)

# Muestra las predicciones
print(predicciones)

```

```{r}
library(forecast)

# Suponiendo que 'predicciones' es el objeto que contiene las predicciones
# (lo que obtuviste de la función forecast)

# Visualiza las predicciones con intervalos de confianza
plot(predicciones, main = "Predicciones de Tasa de Suicidios",
     xlab = "Año", ylab = "Tasa de Suicidios", ylim = c(0, 30))

```

```{r}
library(forecast)

# Suponiendo que 'data' es tu conjunto de datos
# y tiene las columnas 'Year', 'Alcohol.use.disorders', 'Depression', y 'SuicideRate'

# Filtra los datos hasta el año 2016 para ajustar el modelo
datos_entrenamiento <- data[data$Year <= 2017, ]

# Selecciona las columnas relevantes y crea una serie temporal
serie_temporal_entrenamiento <- ts(datos_entrenamiento$SuicideRate, start = datos_entrenamiento$Year[1], frequency = 1)

# Ajusta un modelo de serie temporal (puedes ajustar otro modelo según tus necesidades)
modelo_serie_temporal <- auto.arima(serie_temporal_entrenamiento)

# Realiza predicciones para los años 2017 al 2025
predicciones_futuras <- forecast(modelo_serie_temporal, h = 2025 - 2017 + 1)

# Muestra las predicciones
print(predicciones_futuras)

```

```{r}
library(forecast)

# Suponiendo que 'predicciones_futuras' es el objeto que contiene las predicciones
# (lo que obtuviste de la función forecast)

# Visualiza las predicciones con intervalos de confianza
plot(predicciones_futuras, main = "Predicciones de Tasa de Suicidios (2017-2025)",
     xlab = "Año", ylab = "Tasa de Suicidios", ylim = c(0, 30))

```
